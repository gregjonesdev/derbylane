{% extends '_base.html'%}
{% load static %}

{% block content %}
  <div
    class="card-header"
    style="border: 1px solid #333; display: flex; flex-flow: row nowrap; justify-content: space-between">
    <a
      class="btn btn-small"
      href="{% url 'frontpage' %}?date={{ previous }}">
      <img
        src="{% static 'img/back.png' %}"
        style="display:inline"
        height=20
        class="float-left"
        alt="back-icon">
    </a>
    <span
      id="date_header"
      class="text-center"
      style="font-size: 1.6em; margin:auto; font-style: italic; font-weight: bold">
      {{ date_header }}
    </span>
    {% if next_day_scheduled %}
    <a
      class="btn btn-small"
      href="{% url 'frontpage' %}?date={{ next }}">
      <img
        src="{% static 'img/forward.png' %}"
        style="display:inline"
        height=20
        class="float-left"
        alt="forward-icon">
    </a>
    {% else %}
    <a
      class="btn btn-small disabled"
      href="{% url 'frontpage' %}?date={{ next }}">
      <img
        src="{% static 'img/forward.png' %}"
        style="display:inline"
        height=20
        class="float-left"
        alt="forward-icon">
    </a>
    {% endif %}
  </div>
  {% if is_past %}
    {% include 'resultsold.html' %}
  {% else %}
    {% include 'predictions.html' %}
  {% endif %}

  {{ datestring }}

  <script id="json-chart-data" type="application/json">
    {
      "bets_url": "{% url 'load_bets' %}",
      "results_url": "{% url 'results' %}",
      "daily_bets_url": "{% url 'get_daily_bets' %}"
    }
  </script>

  <script>
    window.onload = (event) => {
      console.log("heoa")
      const text_content = document.getElementById("json-chart-data").textContent
      const chart_json_data = JSON.parse(text_content)
      const datestring = "{{ datestring }}"
      const daily_bets = document.getElementById("daily_bet_table")
      console.log(chart_json_data["daily_bets_url"] + "?date=" + datestring)

      load_daily_bets = () => {
      console.log(daily_bets)
       if (daily_bets) {
         $.ajax({
           url: chart_json_data["daily_bets_url"] + "?date=" + datestring,
           dataType: "html",
           // data: {
           //   "chart_id": chart_id,
           // },
           success: function(data) {
             $("#daily_bet_table").html(data)
           }
         })
       }
     }

     load_daily_bets()
    };
  </script>

{% endblock content %}
