{% extends '_base.html'%}

{% block content %}

  <h5 class="card-header text-center"><b><i>{{ today }}</i></b></h5>
  <div class= "card-body">
    <select
      class="form-control frontpage-select"
      id="venue-select">
      {% for venue in venues %}
        <option value="{{ venue.code}}">{{ venue }}</option>
      {% endfor %}
    </select>
    <select
      class="form-control frontpage-select"
      id="chart-select">
    </select>

  </div>

  <script id="json-chart-data" type="application/json">
    {
      "charts_url": "{% url 'load_charts' %}"
    }
  </script>
<script>
  venue_select = document.getElementById("venue-select")

  text_content = document.getElementById("json-chart-data").textContent
  chart_json_data = JSON.parse(text_content)
  charts_url = chart_json_data["charts_url"]
  load_charts = () => {
    venue_code = venue_select.value
    $.ajax({
      url: charts_url,
      dataType: "html",
      data: {
        "venue_code": venue_code,

      },
      success: function(data) {
        $("#chart-select").html(data)

      }
    })
  }
  window.onload = (event) => {
    load_charts(venue_select.value)

  };
  venue_select.addEventListener("change", load_charts)
</script>
{% endblock content %}
